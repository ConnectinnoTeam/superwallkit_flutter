appId: com.superwall.superapp
---
- launchApp
- tapOn: "Purchase Controller Test"
- tapOn: "Mock PC Test"
- tapOn: "Configure with PC"
# We mark this as optional as sometimes it triggers but doesnt register as visible
- tapOn: 
    text: "Trigger Paywall"
    waitToSettleTimeoutMs: 1000
    optional: true
- tapOn: "Continue"
- runFlow:
    when:
      visible: "Agree"
    commands:
      - tapOn: "Agree"

# If card is preset to declined, we reselect it to be sure
- runFlow:
    when:
      visible: "Test card, always declines"
    commands:
      - tapOn: "Test card, always declines"
      - tapOn: "Test card, always declines"

# If card is preset to approve, we select declined

- runFlow:
    when:
      visible: "Test card, always approves"
    commands:
      - tapOn: "Test card, always approves"
      - tapOn: "Test card, always declines"


- tapOn: "Subscribe"
- assertVisible: "Declined by always denied test instrument"
- tapOn: "Got it"
- assertVisible: "An error occurred"
- assertVisible: "3"
- tapOn: "Done"
- tapOn: "Continue"
- tapOn: "Test card, always declines"
- tapOn: "Test card, always approves"
- tapOn: "Subscribe"
- assertVisible: "Subscribed"
- assertVisible: "Feature triggered"
- tapOn: "OK"


